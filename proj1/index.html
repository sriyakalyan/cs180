<!DOCTYPE html>
<html>
<head>
    <title>CS 180: Project 1</title>
    <style>
        body {
            font-family: "Raleway", "Helvetica Neue", Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: #fff5f8; 
            color: #333;
            line-height: 1.6;
        }

        h1 {
            text-align: center;
            background: linear-gradient(135deg, #ffccd5, #ffcce7);
            color: #5a2a36;
            padding: 30px 10px;
            margin: 0 0 30px 0;
            font-size: 2em;
            border-bottom: 4px solid #f3a6b5;
            font-weight: bold;
        }

        h1 a {
            color: inherit;
            text-decoration: underline;
        }

        .part {
            background: #fff;
            padding: 20px;
            margin: 20px auto;
            width: 85%;
            max-width: 1000px;
            border-radius: 16px;
            box-shadow: 0 6px 14px rgba(0, 0, 0, 0.08);
            transition: transform 0.25s ease, box-shadow 0.25s ease;
        }

        .part:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.12);
        }

        h2 {
            color: #b84c65;
            margin-top: 0;
        }

        .photo-container {
            display: inline-block;
            margin: 10px;
            text-align: center;
            vertical-align: top;
            width: 200px;        /* fixed container width */
            position: relative;
            overflow: hidden;
        }

        /* Aligned image */
        .photo-container img.aligned {
            display: block;
            border-radius: 12px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.15);
            width: 100%;
            height: auto;
        }

        /* Original image: positioned absolutely, shrinks to fit */
        .photo-container img.original {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;        /* scale to container width */
            height: 100%;       /* scale to container height */
            object-fit: contain; /* preserve aspect ratio, shrink if needed */
            border-radius: 12px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        /* Hover: show original, hide aligned */
        .photo-container:hover img.original {
            opacity: 1;
        }
        .photo-container:hover img.aligned {
            opacity: 0;
        }


        .metrics {
            font-size: 14px;
            color: #333;
        }

        .proj-spec {
            background: #ffd6e8;
            border-left: 6px solid #f78fb3;
            margin: 20px auto;
            padding: 15px 20px;
            width: 85%;
            max-width: 900px;
            border-radius: 8px;
            font-size: 16px;
        }

        .proj-spec a {
            color: #c44569;
            text-decoration: none;
            font-weight: bold;
        }

        .proj-spec a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <h1>
        Programming Project #1: Aligning The 
        <a href="https://www.loc.gov/collections/prokudin-gorskii/" target="_blank">Prokudin-Gorskii</a> Images        
    </h1>

    <!-- Overview -->
    <div class="part">
        <h2>Overview</h2>
        <p>
            Sergei Mikhailovich Prokudin-Gorskii travelled across the Russian Empire to take photographs of what he saw. In order to take color pictures, he decided to take three exposures of every scene using a red, green, and blue filter. Combining these photos allows us to see these images in color.
            <br><br>
            Simply splitting the original image into 3 and stacking them is not enough. Some alignment is needed to ensure the most accurate representation of what Sergei saw at the time.
        </p>

        <div style="display: flex; justify-content: center; margin-top: 20px;">
            <div class="photo-container" style="text-align: center;">
                <img src="assets/original/emir.jpeg" alt="Original Emir" style="max-width: 80%; height: auto; border-radius: 12px; box-shadow: 0 3px 10px rgba(0,0,0,0.15);">
                <div class="photo-label">Emir</div>
            </div>
        </div>
    </div>



    <!-- Part 1: Single-Scale Implementation -->
    <div class="part">
        <h2>Part 1: Single-Scale Implementation</h2>
        <p>
            For single-scale implementation, the red and green images were cropped and then compared to the blue image in order to find the best alignment. Images were displaced with a range of -15 to 15 in both the x and y axes. To determine the best fitting displaced image, the Euclidean Distance (the sum taken over the pixel values) between the displaced image and the control (the blue channel) was taken. The lower the Euclidean Distance, the better the match.
            <br><br>
            While this was quick for smaller images, the algorithm would prove to be inefficient with larger files.
        </p>
        <div style="text-align: center;">
            <div class="photo-container">
                <img class="aligned" src="assets/aligned/cathedral_out.jpeg" alt="Aligned Cathedral">
                <img class="original" src="assets/original/cathedral.jpeg" alt="Original Cathedral">
                <div class="photo-label">Cathedral</div>
                <div class="metrics">
                        Red Displacement: [12, 3]<br>
                        Green Displacement: [5, 2]<br>
                        Time: 0.88 sec
                    </div>
            </div>

            <div class="photo-container">
                <img class="aligned" src="assets/aligned/monastery_out.jpeg" alt="Aligned Monastery">
                <img class="original" src="assets/original/monastery.jpeg" alt="Original Monastery">
                <div class="photo-label">Monastery</div>
                <div class="metrics">
                        Red Displacement: [3, 2]<br>
                        Green Displacement: [-3, 2]<br>
                        Time: 0.94 sec
                    </div>
            </div>

            <div class="photo-container">
                <img class="aligned" src="assets/aligned/tobolsk_out.jpeg" alt="Aligned Tobolsk">
                <img class="original" src="assets/original/tobolsk.jpeg" alt="Original Image 1">
                <div class="photo-label">Tobolsk</div>
                <div class="metrics">
                        Red Displacement: [6, 3]<br>
                        Green Displacement: [3, 3]<br>
                        Time: 1.00 sec
                    </div>
            </div>
        </div>
    </div>

    <!-- Part 2: Multi-Scale Pyramid Alignment -->
    <div class="part">
        <h2>Part 2: Multi-Scale Pyramid Alignment</h2>
        <p>
            Because the single-scale approach was inefficient for larger files, it was essential to find an alternative that could search for alignment much faster. For a larger resolution image, searching over a much larger area is essential; However, with the single-scale method, this would prove to be very inefficient, as thousands of interations would have to run to search a sufficient area.
            <br><br>
            Multi-scale pyramid alignment utilizes a coarse to fine strategy. Starting with a coarse image (1/16th of the original size of the image), the best displacement was found within the same range of -15 to 15 pixels in both axes. After scaling up by 2 each time, the displacement was also doubled and once again, the best displacement was found within the range of -15 to 15 pixels. This allows us to "double" our search area with each iteration and refine our results.
            <br><br>
            Using a NCC metric was considered, but certain functions used to implement NCC has overhead runtime that slowed down the runtime. Additionally, with the exception of Emir, the difference in intensities of the channel was negligible enough to allow for Euclidean Distance to be an accurate metric. As a result, the simple Euclidean Distance was used in the end.
        </p>
        <div style="text-align: center;">
            <div style="text-align: center;">
                <div class="photo-container">
                    <img class="aligned" src="assets/aligned/cathedral_out.jpeg" alt="Aligned Cathedral">
                    <img class="original" src="assets/original/cathedral.jpeg" alt="Original Cathedral">
                    <div class="photo-label">Cathedral</div>
                    <div class="metrics">
                        Red Displacement: [12, 3]<br>
                        Green Displacement: [5, 2]<br>
                        Time: 0.81 sec
                    </div>
                </div>

                <div class="photo-container">
                    <img class="aligned" src="assets/aligned/monastery_out.jpeg" alt="Aligned Monastery">
                    <img class="original" src="assets/original/monastery.jpeg" alt="Original Monastery">
                    <div class="photo-label">Monastery</div>
                    <div class="metrics">
                        Red Displacement: [3, 2]<br>
                        Green Displacement: [-3, 2]<br>
                        Time: 0.55 sec
                    </div>
                </div>

                <div class="photo-container">
                    <img class="aligned" src="assets/aligned/tobolsk_out.jpeg" alt="Aligned Tobolsk">
                    <img class="original" src="assets/original/tobolsk.jpeg" alt="Original Tobolsk">
                    <div class="photo-label">Tobolsk</div>
                    <div class="metrics">
                        Red Displacement: [6, 3]<br>
                        Green Displacement: [3, 3]<br>
                        Time: 0.51 sec
                    </div>
                </div>

                <div class="photo-container">
                    <img class="aligned" src="assets/aligned/church_out.jpeg" alt="Aligned Church">
                    <img class="original" src="assets/original/church.jpeg" alt="Original Church">
                    <div class="photo-label">Church</div>
                    <div class="metrics">
                        Red Displacement: [58, -4]<br>
                        Green Displacement: [25, 4]<br>
                        Time: 48.47 sec
                    </div>
                </div>

                <div class="photo-container">
                    <img class="aligned" src="assets/aligned/emir_out.jpeg" alt="Aligned Emir">
                    <img class="original" src="assets/original/emir.jpeg" alt="Original Emir">
                    <div class="photo-label">Emir</div>
                    <div class="metrics">
                        Red Displacement: [93, -305]<br>
                        Green Displacement: [49, 24]<br>
                        Time: 52.85 sec
                    </div>
                </div>

                <div class="photo-container">
                    <img class="aligned" src="assets/aligned/harvesters_out.jpeg" alt="Aligned Harvesters">
                    <img class="original" src="assets/original/harvesters.jpeg" alt="Original Harvesters">
                    <div class="photo-label">Harvesters</div>
                    <div class="metrics">
                        Red Displacement: [124, 13]<br>
                        Green Displacement: [59, 16]<br>
                        Time: 51.93 sec
                    </div>
                </div>

                <div class="photo-container">
                    <img class="aligned" src="assets/aligned/icon_out.jpeg" alt="Aligned Icon">
                    <img class="original" src="assets/original/icon.jpeg" alt="Original Icon">
                    <div class="photo-label">Icon</div>
                    <div class="metrics">
                        Red Displacement: [89, 23]<br>
                        Green Displacement: [41, 17]<br>
                        Time: 53.47 sec
                    </div>
                </div>

                <div class="photo-container">
                    <img class="aligned" src="assets/aligned/italil_out.jpeg" alt="Aligned Italil">
                    <img class="original" src="assets/original/italil.jpeg" alt="Original Italil">
                    <div class="photo-label">Italil</div>
                    <div class="metrics">
                        Red Displacement: [76, 35]<br>
                        Green Displacement: [38, 21]<br>
                        Time: 52.96 sec
                    </div>
                </div>

                <div class="photo-container">
                    <img class="aligned" src="assets/aligned/lastochikino_out.jpeg" alt="Aligned Lastochikino">
                    <img class="original" src="assets/original/lastochikino.jpeg" alt="Original Lastochikino">
                    <div class="photo-label">Lastochikino</div>
                    <div class="metrics">
                        Red Displacement: [75, -8]<br>
                        Green Displacement: [-2, -2]<br>
                        Time: 52.64 sec
                    </div>
                </div>

                <div class="photo-container">
                    <img class="aligned" src="assets/aligned/lugano_out.jpeg" alt="Aligned Lugano">
                    <img class="original" src="assets/original/lugano.jpeg" alt="Original Lugano">
                    <div class="photo-label">Lugano</div>
                    <div class="metrics">
                        Red Displacement: [92, -29]<br>
                        Green Displacement: [41, -16]<br>
                        Time: 54.82 sec
                    </div>
                </div>

                <div class="photo-container">
                    <img class="aligned" src="assets/aligned/melons_out.jpeg" alt="Aligned Melons">
                    <img class="original" src="assets/original/melons.jpeg" alt="Original Melons">
                    <div class="photo-label">Melons</div>
                    <div class="metrics">
                        Red Displacement: [178, 13]<br>
                        Green Displacement: [81, 10]<br>
                        Time: 53.93 sec
                    </div>
                </div>

                <div class="photo-container">
                    <img class="aligned" src="assets/aligned/self_portrait_out.jpeg" alt="Aligned Self Portrait">
                    <img class="original" src="assets/original/self_portrait.jpeg" alt="Original Self Portrait">
                    <div class="photo-label">Self Portrait</div>
                    <div class="metrics">
                        Red Displacement: [176, 37]<br>
                        Green Displacement: [78, 29]<br>
                        Time: 54.48 sec
                    </div>
                </div>

                <div class="photo-container">
                    <img class="aligned" src="assets/aligned/siren_out.jpeg" alt="Aligned Siren">
                    <img class="original" src="assets/original/siren.jpeg" alt="Original Siren">
                    <div class="photo-label">Siren</div>
                    <div class="metrics">
                        Red Displacement: [95, -25]<br>
                        Green Displacement: [49, -6]<br>
                        Time: 54.45 sec
                    </div>
                </div>

                <div class="photo-container">
                    <img class="aligned" src="assets/aligned/three_generations_out.jpeg" alt="Aligned Three Generations">
                    <img class="original" src="assets/original/three_generations.jpeg" alt="Original Three Generations">
                    <div class="photo-label">Three Generations</div>
                    <div class="metrics">
                        Red Displacement: [112, 11]<br>
                        Green Displacement: [53, 14]<br>
                        Time: 51.05 sec
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Part 3: Extra Images -->
    <div class="part">
        <h2>Part 3: Extra Images</h2>
        <p>These are some extra images that had a certain charm to them.</p>
        <div style="text-align: center;">
            <div class="photo-container">
                <img class="aligned" src="assets/aligned/boat_out.jpeg" alt="Aligned Boat">
                <img class="original" src="assets/original/boat.jpeg" alt="Original Boat">
                <div class="photo-label">Boat</div>
                <div class="metrics">
                    Red Displacement: [16, 20]<br>
                    Green Displacement: [-32, 10]<br>
                    Time: 49.28 sec
                </div>
            </div>

            <div class="photo-container">
                <img class="aligned" src="assets/aligned/quarry_out.jpeg" alt="Aligned Quarry">
                <img class="original" src="assets/original/quarry.jpeg" alt="Original Quarry">
                <div class="photo-label">Quarry</div>
                <div class="metrics">
                    Red Displacement: [130, -9]<br>
                    Green Displacement: [41, -3]<br>
                    Time: 54.94 sec
                </div>
            </div>

            <div class="photo-container">
                <img class="aligned" src="assets/aligned/wharf_out.jpeg" alt="Aligned Wharf">
                <img class="original" src="assets/original/wharf.jpeg" alt="Original Wharf">
                <div class="photo-label">Wharf</div>
                <div class="metrics">
                    Red Displacement: [95, 29]<br>
                    Green Displacement: [23, 15]<br>
                    Time: 54.62 sec
                </div>
            </div>
        </div>
    </div>

    <!-- Part 4: Challenges / Failures -->
    <div class="part">
        <h2>Part 4: Challenges / Failures</h2>
        <p>
            The Emir photograph did not align properly at all. This is due to the varying brightness channels of the glass plates. I attempted to resolve this issue by switching to the NCC metric, but this not only didn't work, it made my program much slower. I will never go back. Please help.
            <br><br>
            This can be solved by using Sobel and using the edges to better align the image. I was sleepy so I did not end up doing this.
        </p>
        <div style="text-align: center;">
            <div class="photo-container">
                <img class="aligned" src="assets/aligned/emir_out.jpeg" alt="Aligned Emir">
                <img class="original" src="assets/original/emir.jpeg" alt="Original Emir">
                <div class="photo-label">Emir</div>
            </div>
        </div>
        <p>
            Another issue I ran into at the beginning of this project was not being able to find a proper alignment within the range of -15 to 15 pixels. This was solved by cropping 10% off of each edge. This allowed the alignment function to run on only the images and not the extra borders.
        </p>
    </div>

    <div class="proj-spec">
        Project 1 Spec: <a href="https://cal-cs180.github.io/fa25/hw/proj1/index.html" target="_blank">
        Aligning Prokudin-Gorskii Images</a>
    </div>

</body>
</html>
